<%# views/member/login.ejs %>

<link rel="stylesheet" href="/member_skins/basic/style.css"> <%# Assuming skin CSS path %>

<div id="mb_login" class="mbskin">
    <div class="mbskin_box">
        <h1><%= locals.g5_title || "로그인" %></h1>
        <div class="mb_log_cate">
            <h2><span class="sound_only">회원</span>로그인</h2>
            <a href="/auth/register" class="join">회원가입</a> <%# Assuming /auth/register route %>
        </div>

        <% if (locals.error && error.length > 0) { %>
            <div class="alert alert-danger" style="color: red; margin-bottom: 10px; padding: 10px; border: 1px solid red;">
                <%= error %>
            </div>
        <% } %>

        <form name="flogin" action="/auth/login<%= locals.redirect ? '?redirect=' + encodeURIComponent(redirect) : '' %>" onsubmit="return flogin_submit(this);" method="post">

        <fieldset id="login_fs">
            <legend>회원로그인</legend>
            <label for="login_id" class="sound_only">회원아이디<strong class="sound_only"> 필수</strong></label>
            <input type="text" name="mb_id" id="login_id" required class="frm_input required" size="20" maxLength="20" placeholder="아이디" value="<%= locals.mb_id || '' %>">

            <label for="login_pw" class="sound_only">비밀번호<strong class="sound_only"> 필수</strong></label>
            <input type="password" name="mb_password" id="login_pw" required class="frm_input required" size="20" maxLength="20" placeholder="비밀번호">

            <button type="submit" class="btn_submit">로그인</button>

            <div id="login_info">
                <div class="login_if_auto chk_box">
                    <input type="checkbox" name="auto_login" id="login_auto_login" class="selec_chk">
                    <label for="login_auto_login"><span></span> 자동로그인</label>
                </div>
                <div class="login_if_lpl">
                    <a href="/auth/password_lost">아이디/비밀번호 찾기</a> <%# Assuming route %>
                </div>
            </div>
        </fieldset>
        </form>
        <%# Social login buttons would go here if implemented %>
        <%# @include_once(get_social_skin_path().'/social_login.skin.php'); %>
    </div>

    <%# Non-member purchase section (if shop is used and configured) %>
    <% if (locals.can_guest_purchase && locals.url_matches_orderform) { %>
    <section id="mb_login_notmb">
        <h2>비회원 구매</h2>
        <p>비회원으로 주문하시는 경우 포인트는 지급하지 않습니다.</p>
        <div id="guest_privacy">
            <%- locals.guest_privacy_content || '개인정보 수집 내용...' %>
        </div>
		<div class="chk_box">
			<input type="checkbox" id="agree" value="1" class="selec_chk">
		<label for="agree"><span></span> 개인정보수집에 대한 내용을 읽었으며 이에 동의합니다.</label>
		</div>
        <div class="btn_confirm">
            <a href="javascript:guest_submit(document.flogin);" class="btn_submit">비회원으로 구매하기</a>
        </div>
        <script>
        function guest_submit(f) {
            if (document.getElementById('agree') && !document.getElementById('agree').checked) {
                alert("개인정보수집에 대한 내용을 읽고 이에 동의하셔야 합니다.");
                return;
            }
            // f.url.value = "<%= locals.order_url %>"; // This hidden input is not in the EJS form
            f.action = "<%= locals.order_url %>"; // Set action to the order URL
            f.submit(); // This will submit the main login form's data
        }
        </script>
    </section>
    <% } else if (locals.url_matches_orderinquiry) { %>
    <div id="mb_login_od_wr">
        <h2>비회원 주문조회</h2>
        <fieldset id="mb_login_od">
            <legend>비회원 주문조회</legend>
            <form name="forderinquiry" method="post" action="<%= locals.order_inquiry_url %>" autocomplete="off">
                <label for="od_id" class="od_id sound_only">주문서번호<strong class="sound_only"> 필수</strong></label>
                <input type="text" name="od_id" value="<%= locals.od_id || '' %>" id="od_id" required class="frm_input required" size="20" placeholder="주문서번호">
                <label for="od_pwd" class="od_pwd sound_only">비밀번호 <strong>필수</strong></label>
                <input type="password" name="od_pwd" size="20" id="od_pwd" required class="frm_input required" placeholder="비밀번호">
                <button type="submit" class="btn_submit">확인</button>
            </form>
        </fieldset>
        <section id="mb_login_odinfo">
            <p>메일로 발송해드린 주문서의 <strong>주문번호</strong> 및 주문 시 입력하신 <strong>비밀번호</strong>를 정확히 입력해주십시오.</p>
        </section>
    </div>
    <% } %>
</div>

<script>
jQuery(function($){
    $("#login_auto_login").click(function(){
        if (this.checked) {
            this.checked = confirm("자동로그인을 사용하시면 다음부터 회원아이디와 비밀번호를 입력하실 필요가 없습니다.\n\n공공장소에서는 개인정보가 유출될 수 있으니 사용을 자제하여 주십시오.\n\n자동로그인을 사용하시겠습니까?");
        }
    });
});

function flogin_submit(f) {
    // Add any client-side validation if needed
    // Example: if (!f.mb_id.value) { alert("아이디를 입력하세요."); f.mb_id.focus(); return false; }
    return true;
}
</script>

<style>
/* Basic styles from login.skin.php for demonstration */
.mbskin { padding: 20px; max-width: 400px; margin: 30px auto; border: 1px solid #ddd; background: #fff; }
.mbskin_box h1 { font-size: 1.8em; text-align: center; margin-bottom: 15px; color: #333; }
.mb_log_cate { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.mb_log_cate h2 { font-size: 1.2em; color: #555; margin:0; }
.mb_log_cate .join { padding: 5px 10px; border: 1px solid #007bff; color: #007bff; text-decoration: none; border-radius: 3px; }
#login_fs .frm_input { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; box-sizing: border-box; }
#login_fs .btn_submit { width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; cursor: pointer; font-size: 1.1em; border-radius: 3px; }
#login_fs .btn_submit:hover { background-color: #0056b3; }
#login_info { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; font-size: 0.9em; }
.chk_box label { display: flex; align-items: center; }
.chk_box input.selec_chk { margin-right: 5px; }
#login_info a { color: #555; text-decoration: none; }

#mb_login_notmb, #mb_login_od_wr { margin-top: 20px; padding-top: 15px; border-top: 1px solid #eee; }
#mb_login_notmb h2, #mb_login_od_wr h2 { font-size: 1.1em; margin-bottom: 10px; }
#guest_privacy { padding:10px; border:1px solid #eee; margin-bottom:10px; font-size:0.9em; max-height:100px; overflow-y:auto; }
#mb_login_notmb .btn_confirm a { display:block; text-align:center; padding:10px; background:#6c757d; color:white; text-decoration:none; border-radius:3px; }
#mb_login_od .frm_input { width: calc(100% - 70px); } /* Adjust if button is inline */
#mb_login_od .btn_submit { width: 60px; }
#mb_login_odinfo { margin-top:10px; font-size:0.9em; color:#777; }
</style>
